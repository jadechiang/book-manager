$(document).ready(function() {
	// 修改密码
	$('#form-password-update').bootstrapValidator( {
		message : '值不能为空',
		feedbackIcons : {
			valid : 'glyphicon glyphicon-ok',
			invalid : 'glyphicon glyphicon-remove',
			validating : 'glyphicon glyphicon-refresh'
		},
		submitHandler : function(validator, form, submitButton) {
			$.sendRequest( {
				url : form.attr('action'),
				data : form.serialize(),
				callback : function(data) {
					if (1 == data.status) {
						$.info(data.msg);
						$('#dialog-password-update').modal('hide');
						$('#form-password-update').bootstrapValidator('resetForm', true);
					} else {
						$.error(data.msg);
					}
				}
			});
		}
	});
	//重置
	$("#resetPwd").on('click', function() {
		$('#form-password-update').bootstrapValidator('resetForm', true);
	});
	//系统设置
	$("#btn-setup").on('click', function() {
		var storeId=$("#stores").select2("val");
		if(storeId){
			$.sendRequest( {
				url : '/setup.do',
				data : {storeId:storeId},
				callback : function(data) {
					location.reload(true);
				}
			});
		}else{
			$.error("请选择店铺！");
		}
	});
	//系统设置并保存
	$("#btn-setup-update").on('click', function() {
		var storeId=$("#stores").select2("val");
		if(storeId){
			$.sendRequest( {
				url : '/setup.do',
				data : {storeId:storeId,type:1},
				callback : function(data) {
					location.reload(true);
				}
			});
		}else{
			$.error("请选择店铺！");
		}
	});
});
